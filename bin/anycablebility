#!/usr/bin/env ruby

require 'bundler/setup'
require 'docopt'
require 'anycablebility/version'
require 'anycablebility/cli/app'

usage = <<~USAGE
  Anycablebility â€“ AnyCable websocket server conformance tool.

  Usage:
    anycablebility [--target TARGET_WS_URL] [--redis REDIS_URL] [--debug]
    anycablebility -h | --help
    anycablebility --version

  Options:
    -h --help               Show this screen.
    --version               Show version.
    --target TARGET_WS_URL  URL of target WebSocket server to test [default: ws://0.0.0.0:8080/cable].
    --redis REDIS_URL       Redis server URL [default: redis://localhost:6379].
    --debug                 Enable debug mode.
USAGE

begin
  args = Docopt::docopt(usage, version: Anycablebility::VERSION)
rescue Docopt::Exit => e
  puts e.message
  exit
end

app = Anycablebility::Cli::App.new(args)
app.run
